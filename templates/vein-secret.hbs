{{!-- =============================== --}}
{{!--   VEIN — SECRETS (as a TAB)     --}}
{{!-- =============================== --}}

{{#with (lookup tabs "secrets") as |tab|}}
<section class="tab {{tab.cssClass}}" data-tab="{{tab.id}}" data-group="{{tab.group}}">

{{!-- ========================== --}}
{{!-- Cartes : Vein Level / Awakening / Awakening Loss --}}
{{!-- ========================== --}}
<div class="vein-cards flexrow">

  {{!-- Vein Level --}}
  <div class="card vein-card gold">
    <div class="header flexrow">
      <h3>{{ localize "Valombreuse5eGMG.ui.veinLevel" }}</h3>
    </div>
    <menu>
      <li>
        <span class="value">{{ @root.valombreuse.veinLevel }}</span>
      </li>
    </menu>
  </div>

  {{!-- Awakening --}}
  <div class="card vein-card gold">
    <div class="header flexrow">
      <h3>{{ localize "Valombreuse5eGMG.ui.awakening" }}</h3>
    </div>
    <menu>
      <li>
        <span class="value">{{ @root.valombreuse.awakening }}</span>
      </li>
    </menu>
  </div>

  {{!-- Awakening Loss (editable si la fiche est éditable) --}}
<div class="card vein-card gold">
  <div class="header flexrow">
    <h3>{{ localize "Valombreuse5eGMG.ui.awakeningLoss" }}</h3>
  </div>
  <menu>
    <li>
      {{#if @root.editable}}
        <input class="vein-awakening-loss-input"
               type="number"
               min="0"
               step="1"
               value="{{ @root.valombreuse.awakeningLoss }}"
               placeholder="0"
               aria-label="{{ localize 'Valombreuse5eGMG.ui.awakeningLoss' }}"
               title="{{ localize 'Valombreuse5eGMG.ui.awakeningLossHint' }}">
      {{else}}
        <span class="value">{{ @root.valombreuse.awakeningLoss }}</span>
      {{/if}}
    </li>
  </menu>
</div>

</div>

{{!-- Hint drag & drop --}}
<p class="hint">
  <i class="fa-solid fa-circle-info"></i>
  {{localize "Valombreuse5eGMG.secrets.hintDrag"}}
  <br>
  <i class="fa-solid fa-hand-pointer"></i>
  {{localize "Valombreuse5eGMG.secrets.hintDrop"}}
</p>

  {{!-- ========================== --}}
  {{!-- Secrets Sections (dropzones) --}}
  {{!-- ========================== --}}
  <section class="secrets-wrapper" data-section="secrets">

    {{!-- ===== GENESIS ===== --}}
    <section class="secrets-section" data-type="secretgenesis">
      <header class="secrets-header flexrow">
        <h3 class="secrets-title">{{ localize "Valombreuse5eGMG.secretgenesis" }}</h3>
      </header>

      <ol class="secrets-list">
        {{#each (getSecretsByType @root.actor "secretgenesis") as |secret|}}
          <li class="secret-row flexrow" data-item-id="{{secret.id}}" draggable="true">
            <div class="secret-name">
              <a class="secret-link"
                 data-action="openSecret"
                 data-item-id="{{secret.id}}"
                 data-tooltip-direction="UP"
                 data-tooltip="{{{stripHTML secret.system.description.value}}}"
                 title="{{{stripHTML secret.system.description.value}}}">
                {{ secret.name }}
              </a>
            </div>
            <div class="secret-level">{{ getSecretLevel secret }}</div>
            <div class="secret-controls">
              <a class="action-button secret-remove"
                 data-action="removeSecret"
                 title="{{ localize "Valombreuse5eGMG.secrets.remove" }}">
                <i class="fa-solid fa-xmark"></i>
              </a>
            </div>
          </li>
        {{else}}
          <li class="secret-row secret-row--empty">
            {{ localize "Valombreuse5eGMG.secrets.none" }}
          </li>
        {{/each}}
      </ol>
    </section>

    {{!-- ===== WORLD ===== --}}
    <section class="secrets-section" data-type="secretworld">
      <header class="secrets-header flexrow">
        <h3 class="secrets-title">{{ localize "Valombreuse5eGMG.secretworld" }}</h3>
      </header>

      <ol class="secrets-list">
        {{#each (getSecretsByType @root.actor "secretworld") as |secret|}}
          <li class="secret-row flexrow" data-item-id="{{secret.id}}" draggable="true">
            <div class="secret-name">
              <a class="secret-link"
                 data-action="openSecret"
                 data-item-id="{{secret.id}}"
                 data-tooltip-direction="UP"
                 data-tooltip="{{{stripHTML secret.system.description.value}}}"
                 title="{{{stripHTML secret.system.description.value}}}">
                {{ secret.name }}
              </a>
            </div>
            <div class="secret-level">{{ getSecretLevel secret }}</div>
            <div class="secret-controls">
              <a class="action-button secret-remove"
                 data-action="removeSecret"
                 title="{{ localize "Valombreuse5eGMG.secrets.remove" }}">
                <i class="fa-solid fa-xmark"></i>
              </a>
            </div>
          </li>
        {{else}}
          <li class="secret-row secret-row--empty">
            {{ localize "Valombreuse5eGMG.secrets.none" }}
          </li>
        {{/each}}
      </ol>
    </section>

    {{!-- ===== BLOODLINE ===== --}}
    <section class="secrets-section" data-type="secretbloodline">
      <header class="secrets-header flexrow">
        <h3 class="secrets-title">{{ localize "Valombreuse5eGMG.secretbloodline" }}</h3>
      </header>

      <ol class="secrets-list">
        {{#each (getSecretsByType @root.actor "secretbloodline") as |secret|}}
          <li class="secret-row flexrow" data-item-id="{{secret.id}}" draggable="true">
            <div class="secret-name">
              <a class="secret-link"
                 data-action="openSecret"
                 data-item-id="{{secret.id}}"
                 data-tooltip-direction="UP"
                 data-tooltip="{{{stripHTML secret.system.description.value}}}"
                 title="{{{stripHTML secret.system.description.value}}}">
                {{ secret.name }}
              </a>
            </div>
            <div class="secret-level">{{ getSecretLevel secret }}</div>
            <div class="secret-controls">
              <a class="action-button secret-remove"
                 data-action="removeSecret"
                 title="{{ localize "Valombreuse5eGMG.secrets.remove" }}">
                <i class="fa-solid fa-xmark"></i>
              </a>
            </div>
          </li>
        {{else}}
          <li class="secret-row secret-row--empty">
            {{ localize "Valombreuse5eGMG.secrets.none" }}
          </li>
        {{/each}}
      </ol>
    </section>

    {{!-- ===== ORDER ===== --}}
    <section class="secrets-section" data-type="secretorder">
      <header class="secrets-header flexrow">
        <h3 class="secrets-title">{{ localize "Valombreuse5eGMG.secretorder" }}</h3>
      </header>

      <ol class="secrets-list">
        {{#each (getSecretsByType @root.actor "secretorder") as |secret|}}
          <li class="secret-row flexrow" data-item-id="{{secret.id}}" draggable="true">
            <div class="secret-name">
              <a class="secret-link"
                 data-action="openSecret"
                 data-item-id="{{secret.id}}"
                 data-tooltip-direction="UP"
                 data-tooltip="{{{stripHTML secret.system.description.value}}}"
                 title="{{{stripHTML secret.system.description.value}}}">
                {{ secret.name }}
              </a>
            </div>
            <div class="secret-level">{{ getSecretLevel secret }}</div>
            <div class="secret-controls">
              <a class="action-button secret-remove"
                 data-action="removeSecret"
                 title="{{ localize "Valombreuse5eGMG.secrets.remove" }}">
                <i class="fa-solid fa-xmark"></i>
              </a>
            </div>
          </li>
        {{else}}
          <li class="secret-row secret-row--empty">
            {{ localize "Valombreuse5eGMG.secrets.none" }}
          </li>
        {{/each}}
      </ol>
    </section>

  </section>
</section>
{{/with}}
